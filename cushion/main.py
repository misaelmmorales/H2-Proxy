################################################################
########################    H2 Proxy    ########################
################# Misael Morales & Shaowen Mao #################
################# Los Alamos National Laboratoy ################
########################## Summer 2023 #########################
################################################################
from utils import *
clear_session()
check_tensorflow_gpu()

h2 = h2proxy()

########################## PROCESSING ##########################
h2.read_data(n_subsample=5000)
h2.process_data()

############################## ROM #############################
h2.make_model()
if h2.NN_verbose==True:
    h2.model.summary()
h2.plot_loss()
h2.make_predictions()

######################## PLOTS & PRINTS ########################
h2.print_metrics()
h2.plot_results()
h2.save_data()

################################################################
############################## END #############################
################################################################